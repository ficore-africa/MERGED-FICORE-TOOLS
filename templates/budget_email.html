<!DOCTYPE html>
<html lang="{{ language if language in ['en', 'ha'] else 'en' }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ translations[language].get('Your Budget Report', translations['en']['Your Budget Report']) }}</title>
    <style>
        body { font-family: 'Poppins', Arial, sans-serif; background: #F5F7FA; margin: 0; padding: 20px; color: #333; }
        .container { max-width: 600px; margin: 0 auto; background: #FFFFFF; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.1); }
        .header { background: linear-gradient(135deg, #2E7D32, #0288D1); padding: 20px; border-radius: 10px 10px 0 0; text-align: center; }
        .header h2 { color: #FFFFFF; margin: 0; font-size: 24px; }
        .header p { font-style: italic; color: #E0F7FA; font-size: 14px; margin: 5px 0 0 0; }
        .content { padding: 20px; }
        .summary-box { border: 2px solid #2E7D32; background: #E8F5E9; border-radius: 12px; padding: 20px; margin-bottom: 20px; }
        .badges-box { border: 2px solid #FBC02D; background: #FFFDE7; border-radius: 12px; padding: 20px; margin-bottom: 20px; }
        .tips-box { border: 2px solid #0288D1; background: #E3F2FD; border-radius: 12px; padding: 20px; margin-bottom: 20px; }
        .section-header { color: #2E7D32; font-weight: 600; font-size: 18px; margin-bottom: 15px; }
        .deficit { color: #D32F2F; font-weight: 600; }
        .chart-box { border: 2px solid #0288D1; background: #E3F2FD; border-radius: 12px; padding: 20px; margin-bottom: 20px; text-align: center; }
        .chart-box img { max-width: 100%; height: auto; }
        .button { display: inline-block; padding: 12px 32px; background: linear-gradient(135deg, #2E7D32, #0288D1); color: #FFFFFF; text-decoration: none; border-radius: 8px; font-weight: 600; font-size: 16px; margin: 10px 0; }
        .button:hover { background: linear-gradient(135deg, #1B5E20, #01579B); color: #FFFFFF; }
        .footer { text-align: center; padding: 20px; background: #f8f9fa; border-radius: 0 0 12px 12px; }
        .footer p { color: #0288D1; font-size: 14px; margin: 0; }
        .footer-links a { color: #2E7D32; margin: 0 10px; font-size: 14px; text-decoration: none; }
        .footer-links a:hover { text-decoration: underline; }
        .social-icons a { color: #0288D1; margin: 0 8px; font-size: 18px; text-decoration: none; }
        .social-icons a:hover { color: #2E7D32; }
        ul { list-style: none; padding: 0; }
        li { margin-bottom: 10px; font-size: 16px; }
        li strong { color: #0288D1; }
        @media only screen and (max-width: 600px) {
            body { padding: 10px; }
            .container { max-width: 100%; }
            .content { padding: 15px; }
            .summary-box, .badges-box, .tips-box, .chart-box { padding: 15px; }
            .button { padding: 10px 20px; font-size: 14px; }
            .chart-box img { width: 100%; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h2>{{ translations[language].get('Your Budget Report', translations['en']['Your Budget Report']) }}</h2>
            <p>{{ translations[language].get('Financial growth passport for Africa', translations['en']['Financial growth passport for Africa']) }}</p>
        </div>
        <div class="content">
            <p>{{ translations[language].get('Dear', translations['en']['Dear']) }} {{ user_name }},</p>
            <p>{{ translations[language].get('Here is your monthly budget summary.', translations['en']['Here is your monthly budget summary.']) }}</p>
            <div class="summary-box" role="region" aria-labelledby="summary-header">
                <h3 id="summary-header" class="section-header">{{ translations[language].get('Summary with Emoji', translations['en']['Summary with Emoji']) }}</h3>
                <ul>
                    <li><strong>{{ translations[language].get('Monthly Income', translations['en']['Monthly Income']) }}:</strong> {{ monthly_income | format_currency('NGN') }}</li>
                    <li><strong>{{ translations[language].get('Housing', translations['en']['Housing']) }}:</strong> {{ housing_expenses | format_currency('NGN') }}</li>
                    <li><strong>{{ translations[language].get('Food', translations['en']['Food']) }}:</strong> {{ food_expenses | format_currency('NGN') }}</li>
                    <li><strong>{{ translations[language].get('Transport', translations['en']['Transport']) }}:</strong> {{ transport_expenses | format_currency('NGN') }}</li>
                    <li><strong>{{ translations[language].get('Other', translations['en']['Other']) }}:</strong> {{ other_expenses | format_currency('NGN') }}</li>
                    <li><strong>{{ translations[language].get('Total Expenses', translations['en']['Total Expenses']) }}:</strong> {{ total_expenses | format_currency('NGN') }}</li>
                    <li><strong>{{ translations[language].get('Savings Goal', translations['en']['Savings Goal']) }}:</strong> {{ savings | format_currency('NGN') }}</li>
                    <li><strong>{{ translations[language].get('Surplus/Deficit', translations['en']['Surplus/Deficit']) }}:</strong> <span {% if surplus_deficit < 0 %}class="deficit"{% endif %}>{{ surplus_deficit | format_currency('NGN') }}</span></li>
                </ul>
            </div>
            <div class="chart-box" role="region" aria-labelledby="chart-header">
                <h3 id="chart-header" class="section-header">{{ translations[language].get('Budget Breakdown', translations['en']['Budget Breakdown']) }}</h3>
                {% if chart_data %}
                    <div>{{ chart_data | safe }}</div>
                {% else %}
                    <p>{{ translations[language].get('Chart Unavailable', translations['en']['Chart Unavailable']) }}</p>
                {% endif %}
            </div>
            <div class="badges-box" role="region" aria-labelledby="badges-header">
                <h3 id="badges-header" class="section-header">{{ translations[language].get('Badges with Emoji', translations['en']['Badges with Emoji']) }}</h3>
                {% if badges %}
                    <ul>
                        {% for badge in badges %}
                            <li aria-label="{{ translations[language].get(badge, translations['en'][badge]) }}">{{ translations[language].get(badge, translations['en'][badge]) }}</li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <p>{{ translations[language].get('No Badges Yet', translations['en']['No Badges Yet']) }}</p>
                {% endif %}
            </div>
            <div class="tips-box" role="region" aria-labelledby="tips-header">
                <h3 id="tips-header" class="section-header">{{ translations[language].get('Tips with Emoji', translations['en']['Tips with Emoji']) }}</h3>
                {% if advice %}
                    <ul>
                        {% for tip in advice %}
                            <li aria-describedby="tip-{{ loop.index }}">{{ translations[language].get(tip, translations['en'][tip]) }}</li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <p>{{ translations[language].get('No tips available.', translations['en']['No tips available.']) }}</p>
                {% endif %}
            </div>
            <div style="text-align: center;">
                <a href="{{ course_url }}" class="button" role="button" aria-label="{{ translations[language].get('Join Financial Course', translations['en']['Join Financial Course']) }}">{{ translations[language].get('Join Course', translations['en']['Join Course']) }}</a>
            </div>
            <p>{{ translations[language].get('Thank you for choosing Ficore Africa!', translations['en']['Thank you for choosing Ficore Africa!']) }}</p>
        </div>
        <div class="footer">
            <p>{{ translations[language].get('About Ficore Africa: Empowering financial growth across Africa since 2023', translations['en']['About Ficore Africa: Empowering financial growth across Africa since 2023']) }}</p>
            <div class="footer-links">
                <a href="{{ FEEDBACK_FORM_URL }}" aria-label="{{ translations[language].get('Provide Feedback', translations['en']['Provide Feedback']) }}">{{ translations[language].get('Feedback', translations['en']['Feedback']) }}</a>
                <a href="{{ WAITLIST_FORM_URL }}" aria-label="{{ translations[language].get('Join Waitlist', translations['en']['Join Waitlist']) }}">{{ translations[language].get('Join Waitlist', translations['en']['Join Waitlist']) }}</a>
                <a href="{{ CONSULTANCY_FORM_URL }}" aria-label="{{ translations[language].get('Book Consultancy', translations['en']['Book Consultancy']) }}">{{ translations[language].get('Consultancy', translations['en']['Consultancy']) }}</a>
            </div>
            <div class="social-icons">
                <a href="{{ linkedin_url }}" aria-label="LinkedIn"><i class="fab fa-linkedin"></i></a>
                <a href="{{ twitter_url }}" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
            </div>
        </div>
    </div>
</body>
</html>
